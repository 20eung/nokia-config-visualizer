---
feature: dictionary-structure-v5
version: v5.0.0
status: design
created: 2026-02-16
author: Claude Code
references:
  - plan: docs/01-plan/features/dictionary-structure-v5.plan.md
---

# Dictionary Structure v5.0 - Design Document

> **Feature**: ì´ë¦„ ì‚¬ì „ êµ¬ì¡° v5.0 - ì–‘ë°©í–¥ ê²€ìƒ‰ ì§€ì›
> **Version**: v5.0.0
> **Status**: ğŸ¨ Design
> **Type**: Data Model Enhancement (Bidirectional Search)

---

## 1. Design Overview

### 1.1 Design Goals

ì´ ì„¤ê³„ëŠ” ì´ë¦„ ì‚¬ì „(Name Dictionary) ë°ì´í„° êµ¬ì¡°ë¥¼ **Config ê²€ìƒ‰ í‚¤ì›Œë“œ**ì™€ **ì‚¬ìš©ì ê²€ìƒ‰ì–´**ë¡œ ì—­í• ì„ ëª…í™•íˆ ë¶„ë¦¬í•˜ì—¬ ì–‘ë°©í–¥ ê²€ìƒ‰ì„ ì§€ì›í•©ë‹ˆë‹¤.

**í•µì‹¬ ì›ì¹™**:
1. **ì—­í•  ë¶„ë¦¬(Role Separation)**: Config í‚¤ì›Œë“œì™€ ì‚¬ìš©ì ê²€ìƒ‰ì–´ë¥¼ ë³„ë„ í•„ë“œë¡œ ê´€ë¦¬
2. **ì–‘ë°©í–¥ ê²€ìƒ‰(Bidirectional Search)**: configKeywordsë„ ì‚¬ìš©ì ì…ë ¥ìœ¼ë¡œ ê²€ìƒ‰ ê°€ëŠ¥
3. **ë‹¤ì¤‘ í‚¤ì›Œë“œ ì§€ì›(Multi-keyword)**: ì—¬ëŸ¬ Config í‚¤ì›Œë“œë¥¼ í•˜ë‚˜ì˜ entryë¡œ ê·¸ë£¹í™”
4. **ê²€ìƒ‰ ì •í™•ë„(Accuracy)**: ê´€ë ¨ëœ ëª¨ë“  Config í‚¤ì›Œë“œë¥¼ ë¹ ì§ì—†ì´ ê²€ìƒ‰

### 1.2 Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   v4.3 Dictionary                        â”‚
â”‚  { originalToken: string, aliases: string[] }           â”‚
â”‚  ë¬¸ì œ: Config í‚¤ì›Œë“œì™€ ê²€ìƒ‰ì–´ê°€ í˜¼ì¬                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â†“ ë°±ì—… ìƒì„±
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              {fingerprint}.backup.json                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â†“ ì‚¬ì „ ì‚­ì œ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            AI ìë™ ìƒì„± (v5.0 êµ¬ì¡°)                      â”‚
â”‚  POST /api/dictionary/generate                          â”‚
â”‚  â†’ Claude Sonnet 4 (systemPrompt v5.0)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   v5.0 Dictionary                        â”‚
â”‚  {                                                       â”‚
â”‚    name: string,                  // ê·¸ë£¹ ëŒ€í‘œ ì´ë¦„     â”‚
â”‚    configKeywords: string[],      // Config ê²€ìƒ‰ í‚¤ì›Œë“œ â”‚
â”‚    searchAliases: string[]        // ì‚¬ìš©ì ê²€ìƒ‰ì–´      â”‚
â”‚  }                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â†“ ê²€ìƒ‰ Flow
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AI Chatbot Search                          â”‚
â”‚  1. ì‚¬ìš©ì ì…ë ¥ â†’ configKeywords âˆª searchAliases ë§¤ì¹­  â”‚
â”‚  2. ë§¤ì¹­ ì„±ê³µ â†’ configKeywords ì „ì²´ OR ì¡°ê±´ Config ê²€ìƒ‰â”‚
â”‚  3. ê²°ê³¼ ë°˜í™˜ â†’ matchedAlias, configKeywords, groupNameâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Data Model Design

### 2.1 Type Definitions

#### 2.1.1 DictionaryEntry (Core)

**Before (v4.3)**:
```typescript
// server/src/types.ts
interface DictionaryEntry {
  id: string;
  originalToken: string;        // ë‹¨ì¼ í† í°ë§Œ ê°€ëŠ¥
  aliases: string[];            // Config í‚¤ì›Œë“œ + ê²€ìƒ‰ì–´ í˜¼ì¬
  autoGenerated: boolean;
  userEdited: boolean;
}
```

**After (v5.0)**:
```typescript
// server/src/types.ts
interface DictionaryEntry {
  id: string;                   // UUID (ì˜ˆ: "sk-shielders-001")
  name: string;                  // ê·¸ë£¹ ëŒ€í‘œ ì´ë¦„ (ì˜ˆ: "SKì‰´ë”ìŠ¤")
  configKeywords: string[];      // Config descriptionì—ì„œ ê²€ìƒ‰í•  í‚¤ì›Œë“œë“¤
                                 // (ì˜ˆ: ["Bizen", "ADTCAPS", "SKShielders", "Infosec"])
  searchAliases: string[];       // ì¶”ê°€ ì‚¬ìš©ì ê²€ìƒ‰ì–´ë“¤
                                 // (ì˜ˆ: ["SKì‰´ë”ìŠ¤", "ISAC", "ì¸í¬ì„¹", "SK Shielders"])
  autoGenerated: boolean;        // AI ìë™ ìƒì„± ì—¬ë¶€
  userEdited: boolean;           // ì‚¬ìš©ìê°€ ìˆ˜ì •í–ˆëŠ”ì§€ ì—¬ë¶€
}

// Compact form for AI transmission
interface DictionaryCompact {
  entries: Array<{
    /** name (group representative name) */
    n: string;
    /** configKeywords (Config search targets) */
    k: string[];
    /** searchAliases (user search terms) */
    a: string[];
  }>;
}
```

#### 2.1.2 NameDictionary (Container)

```typescript
// server/src/types.ts, src/types/dictionary.ts
interface NameDictionary {
  version: number;               // 5 (v5.0)
  createdAt: string;             // ISO 8601 timestamp
  updatedAt: string;             // ISO 8601 timestamp
  entries: DictionaryEntry[];    // ì‚¬ì „ í•­ëª© ë°°ì—´
}
```

#### 2.1.3 MatchedEntry (AI Response)

**Before (v4.3)**:
```typescript
// server/src/types.ts
interface MatchedEntry {
  originalToken: string;
  matchedAlias: string;
  allAliases: string[];
}
```

**After (v5.0)**:
```typescript
// server/src/types.ts
interface MatchedEntry {
  matchedAlias: string;       // ì‹¤ì œë¡œ ë§¤ì¹­ëœ í‚¤ì›Œë“œ
                              // (ì˜ˆ: "SKì‰´ë”ìŠ¤", "Bizen")
  configKeywords: string[];   // Config ê²€ìƒ‰ì— ì‚¬ìš©ë  í‚¤ì›Œë“œë“¤
                              // (ì˜ˆ: ["Bizen", "ADTCAPS", "SKShielders", "Infosec"])
  groupName: string;          // entry.name (ì˜ˆ: "SKì‰´ë”ìŠ¤")
}
```

### 2.2 Search Logic Design

#### 2.2.1 User Input Matching

**Rule 1: Bidirectional Matching**
```typescript
// ì‚¬ìš©ì ì…ë ¥ì´ ë§¤ì¹­ë˜ëŠ” ëŒ€ìƒ = configKeywords âˆª searchAliases
const matchEntry = dictionary.entries.find(entry =>
  entry.configKeywords.includes(userInput) ||
  entry.searchAliases.includes(userInput)
);
```

**ê²€ìƒ‰ ì‹œë‚˜ë¦¬ì˜¤**:
| ì‚¬ìš©ì ì…ë ¥ | ë§¤ì¹­ í•„ë“œ | ì´ìœ  |
|------------|----------|------|
| "Bizen" | configKeywords | Config í‚¤ì›Œë“œ ì§ì ‘ ê²€ìƒ‰ |
| "ADTCAPS" | configKeywords | Config í‚¤ì›Œë“œ ì§ì ‘ ê²€ìƒ‰ |
| "SKì‰´ë”ìŠ¤" | searchAliases | ì‚¬ìš©ì ì¹œí™”ì  ê²€ìƒ‰ì–´ |
| "ISAC" | searchAliases | ì‚¬ìš©ì ì¹œí™”ì  ê²€ìƒ‰ì–´ |

#### 2.2.2 Config Search

**Rule 2: OR Condition Search**
```typescript
// ë§¤ì¹­ëœ entryì˜ configKeywords ì „ì²´ë¥¼ OR ì¡°ê±´ìœ¼ë¡œ Config ê²€ìƒ‰
if (matchEntry) {
  // Config descriptionì—ì„œ configKeywords ì¤‘ í•˜ë‚˜ë¼ë„ í¬í•¨ëœ ì„œë¹„ìŠ¤ ì°¾ê¸°
  const matchedServices = config.services.filter(service =>
    matchEntry.configKeywords.some(keyword =>
      service.description.includes(keyword)
    )
  );
}
```

**ê²€ìƒ‰ ì˜ˆì‹œ**:
- ì‚¬ìš©ì ì…ë ¥: "SKì‰´ë”ìŠ¤"
- ë§¤ì¹­: searchAliasesì—ì„œ ë°œê²¬
- Config ê²€ìƒ‰: `description LIKE '%Bizen%' OR description LIKE '%ADTCAPS%' OR description LIKE '%SKShielders%' OR description LIKE '%Infosec%'`
- ê²°ê³¼: 4ê°œ í‚¤ì›Œë“œ ì¤‘ í•˜ë‚˜ë¼ë„ í¬í•¨ëœ ëª¨ë“  ì„œë¹„ìŠ¤

### 2.3 Data Transformation Rules

#### Rule 1: v4.3 â†’ v5.0 Migration (ìë™ ë¶ˆê°€ëŠ¥)

**ë¬¸ì œ**: v4.3ì˜ aliasesì— Config í‚¤ì›Œë“œì™€ ê²€ìƒ‰ì–´ê°€ í˜¼ì¬ë˜ì–´ ìë™ ë¶„ë¥˜ ë¶ˆê°€ëŠ¥

**Example (v4.3)**:
```json
{
  "originalToken": "Bizen",
  "aliases": ["SKì‰´ë”ìŠ¤", "ADTCAPS", "SKShielders", "Infosec", "ISAC"]
}
```

**ì§ˆë¬¸**: ì–´ë–¤ ê²ƒì´ Config í‚¤ì›Œë“œì´ê³  ì–´ë–¤ ê²ƒì´ ê²€ìƒ‰ì–´ì¸ê°€?
- Config í‚¤ì›Œë“œ: Bizen, ADTCAPS, SKShielders, Infosec (ì˜ë¬¸, Configì— ì‹¤ì œ ì¡´ì¬)
- ê²€ìƒ‰ì–´: SKì‰´ë”ìŠ¤, ISAC, ì¸í¬ì„¹ (í•œê¸€, ì‚¬ìš©ì ì…ë ¥)

**í•´ê²°**: AI ì¬ìƒì„± ê¶Œì¥ (ì‚¬ìš©ìê°€ ìƒì„± ê²°ê³¼ ê²€í†  í›„ ìˆ˜ì •)

#### Rule 2: AI Generation Prompt (v5.0)

```typescript
// server/src/services/dictionaryGenerator.ts
const prompt = `
ê° descriptionì„ ë¶„ì„í•˜ì—¬ ë‹¤ìŒ í˜•ì‹ì˜ JSON ë°°ì—´ì„ ìƒì„±í•˜ì„¸ìš”:

{
  "entries": [
    {
      "name": "ê·¸ë£¹ ëŒ€í‘œ ì´ë¦„ (í•œêµ­ì–´ ìš°ì„ )",
      "configKeywords": ["Config descriptionì— ì‹¤ì œ ì¡´ì¬í•˜ëŠ” í‚¤ì›Œë“œë“¤"],
      "searchAliases": ["ì‚¬ìš©ìê°€ ì…ë ¥í•  ê²€ìƒ‰ì–´ë“¤ (í•œê¸€, ì•½ì ë“±)"]
    }
  ]
}

ì˜ˆì‹œ:
- description: "SK Shielders Bizen ADTCAPS Infosec íšŒì„ "
- output:
  {
    "name": "SKì‰´ë”ìŠ¤",
    "configKeywords": ["Bizen", "ADTCAPS", "SKShielders", "Infosec"],
    "searchAliases": ["SKì‰´ë”ìŠ¤", "ISAC", "ì¸í¬ì„¹", "ì—ìŠ¤ì¼€ì´ì‰´ë”ìŠ¤"]
  }
`;
```

### 2.4 Example Transformations

#### Example 1: SKì‰´ë”ìŠ¤ (ë³µì¡í•œ ì¼€ì´ìŠ¤)

**v4.3 (Before)**:
```json
{
  "id": "sk-shielders-001",
  "originalToken": "Bizen",
  "aliases": ["SKì‰´ë”ìŠ¤", "ADTCAPS", "SKShielders", "Infosec", "ISAC"],
  "autoGenerated": true,
  "userEdited": false
}
```

**v5.0 (After)**:
```json
{
  "id": "sk-shielders-001",
  "name": "SKì‰´ë”ìŠ¤",
  "configKeywords": ["Bizen", "ADTCAPS", "SKShielders", "Infosec"],
  "searchAliases": ["SKì‰´ë”ìŠ¤", "ISAC", "ì¸í¬ì„¹", "ì—ìŠ¤ì¼€ì´ì‰´ë”ìŠ¤", "SK Shielders"],
  "autoGenerated": true,
  "userEdited": false
}
```

**ê²€ìƒ‰ í…ŒìŠ¤íŠ¸**:
| ì…ë ¥ | ë§¤ì¹­ | Config ê²€ìƒ‰ |
|------|------|------------|
| "Bizen" | configKeywords | Bizen, ADTCAPS, SKShielders, Infosec |
| "ADTCAPS" | configKeywords | Bizen, ADTCAPS, SKShielders, Infosec |
| "SKì‰´ë”ìŠ¤" | searchAliases | Bizen, ADTCAPS, SKShielders, Infosec |
| "ISAC" | searchAliases | Bizen, ADTCAPS, SKShielders, Infosec |

#### Example 2: ê°„ë‹¨í•œ ì¼€ì´ìŠ¤

**v4.3 (Before)**:
```json
{
  "id": "seoul-001",
  "originalToken": "Seoul",
  "aliases": ["ì„œìš¸", "SEO"],
  "autoGenerated": true,
  "userEdited": false
}
```

**v5.0 (After)**:
```json
{
  "id": "seoul-001",
  "name": "ì„œìš¸",
  "configKeywords": ["Seoul"],
  "searchAliases": ["ì„œìš¸", "SEO"],
  "autoGenerated": true,
  "userEdited": false
}
```

---

## 3. API Design

### 3.1 systemPrompt.ts (v5.0)

#### 3.1.1 Dictionary Section

**Location**: `server/src/prompts/systemPrompt.ts`

**Content**:
```typescript
## Name Dictionary í™œìš© (ì´ë¦„ ì‚¬ì „) - v5.0

ì‚¬ìš©ì ë©”ì‹œì§€ì— "Name Dictionary" ì„¹ì…˜ì´ í¬í•¨ëœ ê²½ìš°, ë‹¤ìŒê³¼ ê°™ì´ í™œìš©í•˜ì„¸ìš”:

### 1. Dictionary êµ¬ì¡° ì´í•´

ê° dictionary entryëŠ” ë‹¤ìŒ 3ê°œ í•„ë“œë¡œ êµ¬ì„±ë©ë‹ˆë‹¤:
- **name**: ê·¸ë£¹ ëŒ€í‘œ ì´ë¦„ (UI í‘œì‹œìš©, ì˜ˆ: "SKì‰´ë”ìŠ¤")
- **configKeywords**: Config descriptionì—ì„œ ê²€ìƒ‰í•  í‚¤ì›Œë“œë“¤ (ì˜ˆ: ["Bizen", "ADTCAPS", "SKShielders", "Infosec"])
- **searchAliases**: ì¶”ê°€ ì‚¬ìš©ì ê²€ìƒ‰ì–´ë“¤ (ì˜ˆ: ["SKì‰´ë”ìŠ¤", "ISAC", "ì¸í¬ì„¹"])

### 2. ì‚¬ìš©ì ì…ë ¥ ë§¤ì¹­ (Bidirectional Search)

ì‚¬ìš©ì ì…ë ¥ì€ **configKeywords + searchAliases** ì „ì²´ì—ì„œ ë§¤ì¹­í•©ë‹ˆë‹¤:
- **configKeywordsì—ì„œ ë§¤ì¹­**: Config í‚¤ì›Œë“œë¥¼ ì§ì ‘ ì…ë ¥í•œ ê²½ìš°
  - ì˜ˆ: ì‚¬ìš©ì ì…ë ¥ "Bizen" â†’ configKeywords: ["Bizen", ...] ë§¤ì¹­
  - ì˜ˆ: ì‚¬ìš©ì ì…ë ¥ "ADTCAPS" â†’ configKeywords: [..., "ADTCAPS", ...] ë§¤ì¹­
- **searchAliasesì—ì„œ ë§¤ì¹­**: ì‚¬ìš©ì ì¹œí™”ì  ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•œ ê²½ìš°
  - ì˜ˆ: ì‚¬ìš©ì ì…ë ¥ "SKì‰´ë”ìŠ¤" â†’ searchAliases: ["SKì‰´ë”ìŠ¤", ...] ë§¤ì¹­
  - ì˜ˆ: ì‚¬ìš©ì ì…ë ¥ "ISAC" â†’ searchAliases: [..., "ISAC", ...] ë§¤ì¹­

**ì¤‘ìš”**: configKeywords ìì²´ë„ ì‚¬ìš©ìê°€ ì§ì ‘ ì…ë ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” ì–‘ë°©í–¥ ê²€ìƒ‰(Bidirectional Search)ì„ ì˜ë¯¸í•©ë‹ˆë‹¤.

### 3. Config ê²€ìƒ‰ (OR Condition)

ë§¤ì¹­ëœ entryì˜ **configKeywords ì „ì²´**ë¥¼ OR ì¡°ê±´ìœ¼ë¡œ Config descriptionì—ì„œ ê²€ìƒ‰í•©ë‹ˆë‹¤:
- ì˜ˆ: configKeywords: ["Bizen", "ADTCAPS", "SKShielders", "Infosec"]
- Config ê²€ìƒ‰: descriptionì— "Bizen" OR "ADTCAPS" OR "SKShielders" OR "Infosec" í¬í•¨
- ê²°ê³¼: 4ê°œ í‚¤ì›Œë“œ ì¤‘ **í•˜ë‚˜ë¼ë„** í¬í•¨ëœ ëª¨ë“  ì„œë¹„ìŠ¤ë¥¼ ì°¾ìŠµë‹ˆë‹¤

### 4. matchedEntries ìƒì„±

ë§¤ì¹­ëœ Dictionary í•­ëª©ì„ matchedEntries ë°°ì—´ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤:

```json
{
  "matchedEntries": [
    {
      "matchedAlias": "SKì‰´ë”ìŠ¤",  // ì‹¤ì œ ë§¤ì¹­ëœ í‚¤ì›Œë“œ (configKeywords ë˜ëŠ” searchAliases ì¤‘)
      "configKeywords": ["Bizen", "ADTCAPS", "SKShielders", "Infosec"],  // Config ê²€ìƒ‰ì— ì‚¬ìš©ë  í‚¤ì›Œë“œë“¤
      "groupName": "SKì‰´ë”ìŠ¤"  // entry.name
    }
  ]
}
```

### 5. ê²€ìƒ‰ ì˜ˆì‹œ

**ì‹œë‚˜ë¦¬ì˜¤ 1: Config í‚¤ì›Œë“œ ì§ì ‘ ì…ë ¥**
- ì‚¬ìš©ì ì…ë ¥: "Bizen"
- ë§¤ì¹­: configKeywordsì—ì„œ "Bizen" ë°œê²¬
- Config ê²€ìƒ‰: ["Bizen", "ADTCAPS", "SKShielders", "Infosec"] ì „ì²´ OR ì¡°ê±´ ê²€ìƒ‰
- ê²°ê³¼: 4ê°œ í‚¤ì›Œë“œ ì¤‘ í•˜ë‚˜ë¼ë„ í¬í•¨ëœ ëª¨ë“  ì„œë¹„ìŠ¤

**ì‹œë‚˜ë¦¬ì˜¤ 2: ì‚¬ìš©ì ì¹œí™”ì  ê²€ìƒ‰ì–´ ì…ë ¥**
- ì‚¬ìš©ì ì…ë ¥: "SKì‰´ë”ìŠ¤"
- ë§¤ì¹­: searchAliasesì—ì„œ "SKì‰´ë”ìŠ¤" ë°œê²¬
- Config ê²€ìƒ‰: ["Bizen", "ADTCAPS", "SKShielders", "Infosec"] ì „ì²´ OR ì¡°ê±´ ê²€ìƒ‰
- ê²°ê³¼: 4ê°œ í‚¤ì›Œë“œ ì¤‘ í•˜ë‚˜ë¼ë„ í¬í•¨ëœ ëª¨ë“  ì„œë¹„ìŠ¤

**ì‹œë‚˜ë¦¬ì˜¤ 3: ì—¬ëŸ¬ entry ë§¤ì¹­**
- ì‚¬ìš©ì ì…ë ¥: "SKì‰´ë”ìŠ¤ì™€ LG U+" (ë³µí•© ê²€ìƒ‰)
- ë§¤ì¹­ 1: "SKì‰´ë”ìŠ¤" â†’ configKeywords: ["Bizen", "ADTCAPS", ...]
- ë§¤ì¹­ 2: "LG U+" â†’ configKeywords: ["LGUplus", "LGUPLUS", ...]
- Config ê²€ìƒ‰: (Bizen OR ADTCAPS OR ...) OR (LGUplus OR LGUPLUS OR ...)
- ê²°ê³¼: ë‘ ê·¸ë£¹ì˜ í‚¤ì›Œë“œ ì¤‘ í•˜ë‚˜ë¼ë„ í¬í•¨ëœ ëª¨ë“  ì„œë¹„ìŠ¤

### 6. ì£¼ì˜ì‚¬í•­

- Dictionaryê°€ ì—†ìœ¼ë©´ ê¸°ì¡´ ë°©ì‹ëŒ€ë¡œ ì§ì ‘ í‚¤ì›Œë“œ ë§¤ì¹­í•©ë‹ˆë‹¤
- configKeywordsëŠ” Config descriptionì— ì‹¤ì œ ì¡´ì¬í•˜ëŠ” í‚¤ì›Œë“œì—¬ì•¼ í•©ë‹ˆë‹¤
- searchAliasesëŠ” ì‚¬ìš©ìê°€ ì…ë ¥í•  ê°€ëŠ¥ì„±ì´ ìˆëŠ” ëª¨ë“  ê²€ìƒ‰ì–´ë¥¼ í¬í•¨í•©ë‹ˆë‹¤
- ë¶€ë¶„ ë§¤ì¹­(fuzzy search)ì€ í—ˆìš©í•˜ë˜, ì •í™•í•œ ë§¤ì¹­ì„ ìš°ì„ í•©ë‹ˆë‹¤
```

#### 3.1.2 Response Format

```typescript
## ì‘ë‹µ JSON í˜•ì‹ - v5.0

{
  "selectedKeys": ["epipe-1001", "vpls-2001"],
  "explanation": "SKì‰´ë”ìŠ¤ì— ì—°ê²°ëœ ì„œë¹„ìŠ¤ 8ê°œë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤.",
  "confidence": "high",
  "filterType": "all",
  "matchedEntries": [
    {
      "matchedAlias": "SKì‰´ë”ìŠ¤",  // ì‹¤ì œ ë§¤ì¹­ëœ í‚¤ì›Œë“œ
      "configKeywords": ["Bizen", "ADTCAPS", "SKShielders", "Infosec"],
      "groupName": "SKì‰´ë”ìŠ¤"
    }
  ]
}
```

### 3.2 claudeClient.ts (v5.0)

#### 3.2.1 Dictionary Transmission Format

**Location**: `server/src/services/claudeClient.ts`

**Code**:
```typescript
let dictionarySection = '';
if (dictionary && dictionary.entries.length > 0) {
  const lines = dictionary.entries.map(e => {
    const configKw = e.k.join(', ');  // k = configKeywords
    const searchAl = e.a.length > 0 ? ` | ê²€ìƒ‰ì–´: ${e.a.join(', ')}` : '';  // a = searchAliases
    return `- "${e.n}" â†’ Config: ${configKw}${searchAl}`;  // n = name
  });
  dictionarySection = `\n\n## Name Dictionary (ì´ë¦„ ì‚¬ì „)\n\n${lines.join('\n')}`;
  console.log(`[askClaude] Dictionary ì„¹ì…˜ ì¶”ê°€ (${lines.length}ê°œ í•­ëª©)`);
}
```

**Example Output**:
```
## Name Dictionary (ì´ë¦„ ì‚¬ì „)

- "SKì‰´ë”ìŠ¤" â†’ Config: Bizen, ADTCAPS, SKShielders, Infosec | ê²€ìƒ‰ì–´: SKì‰´ë”ìŠ¤, ISAC, ì¸í¬ì„¹
- "ì„œìš¸" â†’ Config: Seoul | ê²€ìƒ‰ì–´: ì„œìš¸, SEO
```

#### 3.2.2 validateMatchedEntries (v5.0)

```typescript
function validateMatchedEntries(
  entries: MatchedEntry[] | undefined,
  dictionary?: DictionaryCompact
): MatchedEntry[] {
  if (!entries || !dictionary) {
    return [];
  }

  // v5.0: configKeywordsê°€ dictionaryì— ì¡´ì¬í•˜ëŠ”ì§€ ê²€ì¦
  const validKeywords = new Set<string>();
  dictionary.entries.forEach(e => {
    e.k.forEach(keyword => validKeywords.add(keyword));  // k = configKeywords
  });

  return entries.filter(entry => {
    // í•„ìˆ˜ í•„ë“œ ì¡´ì¬ ì—¬ë¶€ í™•ì¸
    if (!entry.matchedAlias || !Array.isArray(entry.configKeywords) || !entry.groupName) {
      return false;
    }

    // configKeywordsê°€ ìµœì†Œ 1ê°œ ì´ìƒ dictionaryì— ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
    const hasValidKeyword = entry.configKeywords.some(kw => validKeywords.has(kw));
    if (!hasValidKeyword) {
      return false;
    }

    return true;
  });
}
```

### 3.3 dictionaryGenerator.ts (v5.0)

#### 3.3.1 Generation Prompt

**Location**: `server/src/services/dictionaryGenerator.ts`

**Code**:
```typescript
const systemPrompt = `
ë‹¹ì‹ ì€ Nokia Config descriptionì„ ë¶„ì„í•˜ì—¬ Name Dictionary v5.0ì„ ìƒì„±í•˜ëŠ” ì „ë¬¸ê°€ì…ë‹ˆë‹¤.

## Dictionary v5.0 êµ¬ì¡°

ê° entryëŠ” ë‹¤ìŒ 3ê°œ í•„ë“œë¡œ êµ¬ì„±ë©ë‹ˆë‹¤:
1. **name**: ê·¸ë£¹ ëŒ€í‘œ ì´ë¦„ (í•œêµ­ì–´ ìš°ì„ , ì˜ˆ: "SKì‰´ë”ìŠ¤")
2. **configKeywords**: Config descriptionì— ì‹¤ì œ ì¡´ì¬í•˜ëŠ” í‚¤ì›Œë“œë“¤ (ì˜ë¬¸, ì˜ˆ: ["Bizen", "ADTCAPS", "SKShielders", "Infosec"])
3. **searchAliases**: ì‚¬ìš©ìê°€ ì…ë ¥í•  ê²€ìƒ‰ì–´ë“¤ (í•œê¸€, ì•½ì ë“±, ì˜ˆ: ["SKì‰´ë”ìŠ¤", "ISAC", "ì¸í¬ì„¹"])

## ìƒì„± ê·œì¹™

1. **configKeywords**: Config descriptionì— **ì‹¤ì œë¡œ ë‚˜íƒ€ë‚˜ëŠ”** ì˜ë¬¸ í‚¤ì›Œë“œë§Œ í¬í•¨
   - ì˜ˆ: "SK Shielders Bizen ADTCAPS" â†’ ["Bizen", "ADTCAPS", "SKShielders"]
   - ì£¼ì˜: descriptionì— ì—†ëŠ” í‚¤ì›Œë“œëŠ” í¬í•¨ ì•ˆ í•¨

2. **searchAliases**: ì‚¬ìš©ìê°€ ì…ë ¥í•  ê°€ëŠ¥ì„±ì´ ìˆëŠ” ëª¨ë“  ê²€ìƒ‰ì–´ í¬í•¨
   - í•œê¸€ ì´ë¦„: "SKì‰´ë”ìŠ¤", "ì—ìŠ¤ì¼€ì´ì‰´ë”ìŠ¤"
   - ì•½ì: "ISAC", "SEO"
   - ì˜ë¬¸ ë³€í˜•: "SK Shielders", "LG Uplus"

3. **ì—°ê´€ í‚¤ì›Œë“œ ê·¸ë£¹í™”**: ë™ì¼í•œ ê³ ê°/íšŒì‚¬ì˜ ì—¬ëŸ¬ Config í‚¤ì›Œë“œë¥¼ í•˜ë‚˜ì˜ entryë¡œ í†µí•©
   - ì˜ˆ: Bizen, ADTCAPS, SKShielders, InfosecëŠ” ëª¨ë‘ SKì‰´ë”ìŠ¤ ê´€ë ¨ â†’ í•˜ë‚˜ì˜ entryë¡œ

4. **ì¤‘ë³µ ì œê±°**: ê°™ì€ í‚¤ì›Œë“œê°€ ì—¬ëŸ¬ entryì— ì¤‘ë³µë˜ì§€ ì•Šë„ë¡ í•¨

5. **ëŒ€ì†Œë¬¸ì ì •ê·œí™”**: configKeywordsëŠ” descriptionì— ë‚˜íƒ€ë‚œ í˜•íƒœ ê·¸ëŒ€ë¡œ ì‚¬ìš©

## ì‘ë‹µ í˜•ì‹

JSON ë°°ì—´ë¡œ ì‘ë‹µí•˜ì„¸ìš”:

\`\`\`json
{
  "entries": [
    {
      "name": "SKì‰´ë”ìŠ¤",
      "configKeywords": ["Bizen", "ADTCAPS", "SKShielders", "Infosec"],
      "searchAliases": ["SKì‰´ë”ìŠ¤", "ISAC", "ì¸í¬ì„¹", "ì—ìŠ¤ì¼€ì´ì‰´ë”ìŠ¤", "SK Shielders"]
    },
    {
      "name": "ì„œìš¸",
      "configKeywords": ["Seoul"],
      "searchAliases": ["ì„œìš¸", "SEO", "ì„œìš¸ì‹œ"]
    }
  ]
}
\`\`\`
`;

const userPrompt = `
ë‹¤ìŒ Config descriptionsì„ ë¶„ì„í•˜ì—¬ Name Dictionary v5.0ì„ ìƒì„±í•˜ì„¸ìš”:

${descriptions.map((d, i) => `${i + 1}. ${d}`).join('\n')}
`;
```

---

## 4. UI Design

### 4.1 DictionaryEditor.tsx (v5.0)

#### 4.1.1 Component Structure

```tsx
// src/components/v3/DictionaryEditor.tsx
interface DictionaryEditorProps {
  dictionary: NameDictionary;
  onSave: (dictionary: NameDictionary) => void;
  onClose: () => void;
}

export function DictionaryEditor({ dictionary, onSave, onClose }: DictionaryEditorProps) {
  // State
  const [entries, setEntries] = useState<DictionaryEntry[]>(dictionary.entries);
  const [editingEntry, setEditingEntry] = useState<DictionaryEntry | null>(null);
  const [isAddMode, setIsAddMode] = useState(false);

  // Handlers
  const handleAdd = () => { /* í•­ëª© ì¶”ê°€ */ };
  const handleEdit = (entry: DictionaryEntry) => { /* í•­ëª© ìˆ˜ì • */ };
  const handleDelete = (id: string) => { /* í•­ëª© ì‚­ì œ */ };
  const handleDeleteAllAndRegenerate = async () => { /* ì „ì²´ ì‚­ì œ í›„ AI ì¬ìƒì„± */ };
  const handleBackupRestore = () => { /* ë°±ì—… ë³µì› */ };

  return (
    <div className="dictionary-editor">
      {/* í—¤ë” */}
      <div className="header">
        <h2>Name Dictionary v5.0</h2>
        <div className="actions">
          <button onClick={handleDeleteAllAndRegenerate}>
            ğŸ”„ ì „ì²´ ì‚­ì œ í›„ AI ì¬ìƒì„±
          </button>
          <button onClick={handleBackupRestore}>
            ğŸ’¾ ë°±ì—… ë³µì›
          </button>
          <button onClick={handleAdd}>
            â• í•­ëª© ì¶”ê°€
          </button>
        </div>
      </div>

      {/* í•­ëª© ëª©ë¡ í…Œì´ë¸” */}
      <table className="entries-table">
        <thead>
          <tr>
            <th>ê·¸ë£¹ ì´ë¦„</th>
            <th>Config í‚¤ì›Œë“œ</th>
            <th>ê²€ìƒ‰ì–´</th>
            <th>ì‘ì—…</th>
          </tr>
        </thead>
        <tbody>
          {entries.map(entry => (
            <tr key={entry.id}>
              <td>{entry.name}</td>
              <td>{entry.configKeywords.join(', ')}</td>
              <td>{entry.searchAliases.join(', ')}</td>
              <td>
                <button onClick={() => handleEdit(entry)}>ìˆ˜ì •</button>
                <button onClick={() => handleDelete(entry.id)}>ì‚­ì œ</button>
              </td>
            </tr>
          ))}
        </tbody>
      </table>

      {/* ì¶”ê°€/ìˆ˜ì • ëª¨ë‹¬ */}
      {(isAddMode || editingEntry) && (
        <EntryModal
          entry={editingEntry}
          onSave={handleSaveEntry}
          onCancel={handleCancelEdit}
        />
      )}
    </div>
  );
}
```

#### 4.1.2 EntryModal Component

```tsx
// src/components/v3/EntryModal.tsx
interface EntryModalProps {
  entry: DictionaryEntry | null;  // null = ì¶”ê°€ ëª¨ë“œ
  onSave: (entry: DictionaryEntry) => void;
  onCancel: () => void;
}

export function EntryModal({ entry, onSave, onCancel }: EntryModalProps) {
  const [name, setName] = useState(entry?.name || '');
  const [configKeywords, setConfigKeywords] = useState(
    entry?.configKeywords.join('\n') || ''
  );
  const [searchAliases, setSearchAliases] = useState(
    entry?.searchAliases.join('\n') || ''
  );

  const handleSave = () => {
    const newEntry: DictionaryEntry = {
      id: entry?.id || `entry-${Date.now()}`,
      name: name.trim(),
      configKeywords: configKeywords.split('\n').map(s => s.trim()).filter(Boolean),
      searchAliases: searchAliases.split('\n').map(s => s.trim()).filter(Boolean),
      autoGenerated: entry?.autoGenerated || false,
      userEdited: true
    };
    onSave(newEntry);
  };

  return (
    <div className="modal-overlay">
      <div className="modal-content">
        <h3>{entry ? 'í•­ëª© ìˆ˜ì •' : 'í•­ëª© ì¶”ê°€'}</h3>

        {/* ê·¸ë£¹ ì´ë¦„ */}
        <div className="form-field">
          <label>
            ê·¸ë£¹ ì´ë¦„ *
            <span className="help-text">
              (ì˜ˆ: SKì‰´ë”ìŠ¤, ì„œìš¸)
            </span>
          </label>
          <input
            type="text"
            value={name}
            onChange={(e) => setName(e.target.value)}
            placeholder="SKì‰´ë”ìŠ¤"
          />
        </div>

        {/* Config í‚¤ì›Œë“œ */}
        <div className="form-field">
          <label>
            Config í‚¤ì›Œë“œ *
            <span className="help-text">
              Config descriptionì—ì„œ ê²€ìƒ‰í•  í‚¤ì›Œë“œë“¤ (ì¤„ë°”ê¿ˆìœ¼ë¡œ êµ¬ë¶„)
            </span>
          </label>
          <textarea
            value={configKeywords}
            onChange={(e) => setConfigKeywords(e.target.value)}
            placeholder="Bizen&#10;ADTCAPS&#10;SKShielders&#10;Infosec"
            rows={5}
          />
        </div>

        {/* ê²€ìƒ‰ì–´ */}
        <div className="form-field">
          <label>
            ê²€ìƒ‰ì–´ (ì„ íƒ)
            <span className="help-text">
              ì‚¬ìš©ìê°€ ì…ë ¥í•  ê²€ìƒ‰ì–´ë“¤ (ì¤„ë°”ê¿ˆìœ¼ë¡œ êµ¬ë¶„)
            </span>
          </label>
          <textarea
            value={searchAliases}
            onChange={(e) => setSearchAliases(e.target.value)}
            placeholder="SKì‰´ë”ìŠ¤&#10;ISAC&#10;ì¸í¬ì„¹&#10;ì—ìŠ¤ì¼€ì´ì‰´ë”ìŠ¤"
            rows={5}
          />
        </div>

        {/* ë²„íŠ¼ */}
        <div className="modal-actions">
          <button onClick={handleSave}>ì €ì¥</button>
          <button onClick={onCancel}>ì·¨ì†Œ</button>
        </div>
      </div>
    </div>
  );
}
```

### 4.2 AliasBadge.tsx (v5.0)

#### 4.2.1 Component Updates

```tsx
// src/components/v3/AliasBadge.tsx
interface AliasBadgeProps {
  matchedEntry: MatchedEntry;  // v5.0 êµ¬ì¡°
}

export function AliasBadge({ matchedEntry }: AliasBadgeProps) {
  const tooltipContent = `
ê·¸ë£¹: ${matchedEntry.groupName}
Config: ${matchedEntry.configKeywords.join(', ')}
ë§¤ì¹­: ${matchedEntry.matchedAlias}
  `.trim();

  return (
    <span className="alias-badge" title={tooltipContent}>
      {matchedEntry.groupName}
      <span className="matched-indicator">
        ({matchedEntry.matchedAlias})
      </span>
    </span>
  );
}
```

---

## 5. Implementation Plan

### 5.1 Phase 1: Backend Changes (Step 1-5)

#### Step 1: íƒ€ì… ì •ì˜ ìˆ˜ì •

**Files**:
- `server/src/types.ts`
- `src/types/dictionary.ts`
- `src/services/chatApi.ts`

**Changes**:
```typescript
// server/src/types.ts
interface DictionaryEntry {
  id: string;
  name: string;                  // ğŸ†•
  configKeywords: string[];      // ğŸ†• (replaces originalToken)
  searchAliases: string[];       // ğŸ†• (replaces aliases)
  autoGenerated: boolean;
  userEdited: boolean;
}

interface DictionaryCompact {
  entries: Array<{
    n: string;    // name
    k: string[];  // configKeywords
    a: string[];  // searchAliases
  }>;
}

interface MatchedEntry {
  matchedAlias: string;        // ìœ ì§€
  configKeywords: string[];    // ğŸ†• (replaces allAliases)
  groupName: string;           // ğŸ†• (replaces originalToken)
}
```

#### Step 2: systemPrompt.ts ì¬ì‘ì„±

**File**: `server/src/prompts/systemPrompt.ts`

**Changes**:
- v5.0 êµ¬ì¡° ì„¤ëª… ì„¹ì…˜ ì¶”ê°€ (Lines 73-150)
- ì–‘ë°©í–¥ ê²€ìƒ‰ ë¡œì§ ìƒì„¸ ì„¤ëª…
- matchedEntries v5.0 í˜•ì‹ ì˜ˆì‹œ

#### Step 3: claudeClient.ts ìˆ˜ì •

**File**: `server/src/services/claudeClient.ts`

**Changes**:
- Dictionary ì „ì†¡ í˜•ì‹ ë³€ê²½ (Lines 68-78):
  ```typescript
  const lines = dictionary.entries.map(e => {
    const configKw = e.k.join(', ');
    const searchAl = e.a.length > 0 ? ` | ê²€ìƒ‰ì–´: ${e.a.join(', ')}` : '';
    return `- "${e.n}" â†’ Config: ${configKw}${searchAl}`;
  });
  ```
- validateMatchedEntries() v5.0 êµ¬ì¡° ê²€ì¦ (Lines 26-54)

#### Step 4: dictionaryGenerator.ts ìˆ˜ì •

**File**: `server/src/services/dictionaryGenerator.ts`

**Changes**:
- AI ìƒì„± í”„ë¡¬í”„íŠ¸ v5.0 êµ¬ì¡°ë¡œ ë³€ê²½
- ì‘ë‹µ íŒŒì‹±: name, configKeywords, searchAliases ì¶”ì¶œ
- ì¤‘ë³µ ì œê±° ë¡œì§: configKeywords ê¸°ì¤€

#### Step 5: dictionaryStore.ts ìˆ˜ì • (ì„ íƒ)

**File**: `server/src/services/dictionaryStore.ts`

**Changes**: ì—†ìŒ (íŒŒì¼ I/Oë§Œ ë‹´ë‹¹, íƒ€ì… ë³€ê²½ ìë™ ë°˜ì˜)

### 5.2 Phase 2: Frontend Changes (Step 6-10)

#### Step 6: íƒ€ì… ì •ì˜ ìˆ˜ì •

**Files**:
- `src/types/dictionary.ts`
- `src/services/chatApi.ts`

**Changes**: Backendì™€ ë™ì¼í•œ íƒ€ì… ì •ì˜ ë™ê¸°í™”

#### Step 7: DictionaryEditor.tsx ì¬ì„¤ê³„

**File**: `src/components/v3/DictionaryEditor.tsx`

**Changes**:
- ì…ë ¥ í•„ë“œ 3ê°œ (name, configKeywords, searchAliases)
- EntryModal ì»´í¬ë„ŒíŠ¸ ë¶„ë¦¬
- "ì „ì²´ ì‚­ì œ í›„ AI ì¬ìƒì„±" ë²„íŠ¼ ì¶”ê°€
- ë°±ì—… ë³µì› ê¸°ëŠ¥ ì¶”ê°€

#### Step 8: EntryModal.tsx ìƒì„±

**File**: `src/components/v3/EntryModal.tsx` (ì‹ ê·œ)

**Content**: 3ê°œ í•„ë“œ ì…ë ¥ ëª¨ë‹¬ (name, configKeywords textarea, searchAliases textarea)

#### Step 9: AliasBadge.tsx ìˆ˜ì •

**File**: `src/components/v3/AliasBadge.tsx`

**Changes**:
- íˆ´íŒ ë‚´ìš© v5.0 êµ¬ì¡°ë¡œ ë³€ê²½
- groupName, configKeywords, matchedAlias í‘œì‹œ

#### Step 10: dictionaryStorage.ts ìˆ˜ì •

**File**: `src/utils/dictionaryStorage.ts`

**Changes**:
- getConfigFingerprint() ìœ ì§€ (ë³€ê²½ ì—†ìŒ)
- createEmptyDictionary() ìœ ì§€ (ë³€ê²½ ì—†ìŒ)
- toDictionaryCompact() v5.0 êµ¬ì¡°ë¡œ ë³€ê²½:
  ```typescript
  function toDictionaryCompact(dict: NameDictionary): DictionaryCompact {
    return {
      entries: dict.entries.map(e => ({
        n: e.name,
        k: e.configKeywords,
        a: e.searchAliases
      }))
    };
  }
  ```

### 5.3 Phase 3: Testing & Deployment (Step 11-15)

#### Step 11: ë°±ì—… ê¸°ëŠ¥ êµ¬í˜„

**File**: `src/components/v3/DictionaryEditor.tsx`

**Function**:
```typescript
async function handleDeleteAllAndRegenerate() {
  // 1. ê¸°ì¡´ ì‚¬ì „ ë°±ì—…
  const backup = { ...dictionary };
  const fingerprint = getConfigFingerprint(configs);
  const backupKey = `${fingerprint}.backup.json`;
  await saveDictionaryToServer(backupKey, backup);

  // 2. ì‚¬ì „ ì‚­ì œ
  const emptyDict = createEmptyDictionary(fingerprint);
  onSave(emptyDict);

  // 3. AI ì¬ìƒì„± ìš”ì²­ (ì‚¬ìš©ì í™•ì¸)
  const proceed = confirm('AIê°€ v5.0 êµ¬ì¡°ë¡œ ìƒˆë¡œ ìƒì„±í•©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?');
  if (proceed) {
    await handleAIGenerate();  // ê¸°ì¡´ AI ìƒì„± ë¡œì§ í˜¸ì¶œ
  }
}
```

#### Step 12: í†µí•© í…ŒìŠ¤íŠ¸

**Test Cases**:
1. **ì „ì²´ ì‚­ì œ í›„ AI ì¬ìƒì„±**:
   - ê¸°ì¡´ v4.3 ì‚¬ì „ ë°±ì—… í™•ì¸
   - AIê°€ v5.0 êµ¬ì¡°ë¡œ ìƒì„± í™•ì¸
   - name, configKeywords, searchAliases í•„ë“œ ì¡´ì¬ í™•ì¸

2. **ì–‘ë°©í–¥ ê²€ìƒ‰ í…ŒìŠ¤íŠ¸**:
   - "Bizen" ì…ë ¥ â†’ configKeywords ë§¤ì¹­ â†’ ëª¨ë“  íšŒì„  í‘œì‹œ
   - "SKì‰´ë”ìŠ¤" ì…ë ¥ â†’ searchAliases ë§¤ì¹­ â†’ ëª¨ë“  íšŒì„  í‘œì‹œ
   - "ADTCAPS" ì…ë ¥ â†’ configKeywords ë§¤ì¹­ â†’ ëª¨ë“  íšŒì„  í‘œì‹œ

3. **í•­ëª© ì¶”ê°€/ìˆ˜ì •**:
   - EntryModalì—ì„œ 3ê°œ í•„ë“œ ì…ë ¥
   - ì €ì¥ í›„ ëª©ë¡ì— ì •ìƒ í‘œì‹œ
   - ìˆ˜ì • í›„ ë³€ê²½ì‚¬í•­ ë°˜ì˜

4. **ë°±ì—… ë³µì›**:
   - ë°±ì—… íŒŒì¼ ì¡´ì¬ í™•ì¸
   - ë³µì› í›„ v4.3 êµ¬ì¡°ë¡œ ë¡¤ë°±

#### Step 13: ë¬¸ì„œ ì—…ë°ì´íŠ¸

**Files**:
- `CLAUDE.md`: v5.0 êµ¬ì¡° ë°˜ì˜
- `docs/release-notes/v5.0.0-dictionary-structure-v5.md`: ë¦´ë¦¬ì¦ˆ ë…¸íŠ¸ ì‘ì„±
- `CHANGELOG.md`: v5.0.0 ì„¹ì…˜ ì¶”ê°€

#### Step 14: ë²„ì „ ì—…ë°ì´íŠ¸

**Files**:
- `package.json`: version "5.0.0"
- `server/package.json`: version "5.0.0"

#### Step 15: Docker ì¬ë¹Œë“œ

```bash
docker compose down
docker compose build --no-cache
docker compose up -d
```

---

## 6. File Changes Summary

### 6.1 Modified Files

| File | Changes | Lines |
|------|---------|:-----:|
| `server/src/types.ts` | DictionaryEntry, DictionaryCompact, MatchedEntry v5.0 | ~50 |
| `server/src/prompts/systemPrompt.ts` | v5.0 êµ¬ì¡° ì„¤ëª…, ì–‘ë°©í–¥ ê²€ìƒ‰ ë¡œì§ | ~80 |
| `server/src/services/claudeClient.ts` | Dictionary ì „ì†¡ í˜•ì‹, validateMatchedEntries v5.0 | ~30 |
| `server/src/services/dictionaryGenerator.ts` | AI ìƒì„± í”„ë¡¬í”„íŠ¸ v5.0 | ~60 |
| `src/types/dictionary.ts` | DictionaryEntry v5.0, MatchedEntry v5.0 | ~30 |
| `src/services/chatApi.ts` | MatchedEntry íƒ€ì… ë™ê¸°í™” | ~10 |
| `src/utils/dictionaryStorage.ts` | toDictionaryCompact() v5.0 | ~10 |
| `src/components/v3/DictionaryEditor.tsx` | 3ê°œ í•„ë“œ ì…ë ¥, ë°±ì—…/ë³µì› ê¸°ëŠ¥ | ~200 |
| `src/components/v3/AliasBadge.tsx` | íˆ´íŒ v5.0 êµ¬ì¡° | ~10 |

**Total**: ~480 lines

### 6.2 New Files

| File | Purpose | Lines |
|------|---------|:-----:|
| `src/components/v3/EntryModal.tsx` | í•­ëª© ì¶”ê°€/ìˆ˜ì • ëª¨ë‹¬ (3ê°œ í•„ë“œ) | ~150 |

**Total**: ~150 lines

### 6.3 Total Changes

- **Modified**: 9 files, ~480 lines
- **New**: 1 file, ~150 lines
- **Grand Total**: ~630 lines

---

## 7. Migration Strategy

### 7.1 User Migration Flow

```
1. ë¸Œë¼ìš°ì €ì—ì„œ Config ì—…ë¡œë“œ
   â†“
2. DictionaryEditor ì—´ê¸°
   â†“
3. "ì „ì²´ ì‚­ì œ í›„ AI ì¬ìƒì„±" ë²„íŠ¼ í´ë¦­
   â†“
4. ë°±ì—… ìë™ ìƒì„± í™•ì¸ ë©”ì‹œì§€
   â†“
5. AIê°€ v5.0 êµ¬ì¡°ë¡œ ìƒˆë¡œ ìƒì„± (ë¡œë”© ìŠ¤í”¼ë„ˆ)
   â†“
6. ìƒì„± ê²°ê³¼ ê²€í†  (name, configKeywords, searchAliases)
   â†“
7. í•„ìš” ì‹œ í•­ëª© ìˆ˜ì • (EntryModal)
   â†“
8. ì €ì¥ â†’ ì„œë²„ì— v5.0 êµ¬ì¡°ë¡œ ì €ì¥
```

### 7.2 Backup & Restore

**ë°±ì—… íŒŒì¼ëª…**: `{fingerprint}.backup.json`

**ë°±ì—… ì‹œì **: "ì „ì²´ ì‚­ì œ í›„ AI ì¬ìƒì„±" ë²„íŠ¼ í´ë¦­ ì‹œ ìë™ ìƒì„±

**ë³µì› ë°©ë²•**:
1. "ë°±ì—… ë³µì›" ë²„íŠ¼ í´ë¦­
2. ë°±ì—… íŒŒì¼ ëª©ë¡ í‘œì‹œ (ë‚ ì§œìˆœ)
3. ë³µì›í•  íŒŒì¼ ì„ íƒ
4. í™•ì¸ â†’ v4.3 êµ¬ì¡°ë¡œ ë¡¤ë°±

### 7.3 Rollback Plan

**ë¬¸ì œ ë°œìƒ ì‹œ**:
1. ë°±ì—… íŒŒì¼ í™•ì¸
2. "ë°±ì—… ë³µì›" ë²„íŠ¼ìœ¼ë¡œ v4.3 ë³µì›
3. Docker ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘
4. ì´ì „ ë²„ì „ìœ¼ë¡œ ë¡¤ë°±

---

## 8. Testing Checklist

### 8.1 Unit Tests

- [ ] DictionaryEntry v5.0 íƒ€ì… ê²€ì¦
- [ ] validateMatchedEntries() v5.0 ë¡œì§
- [ ] toDictionaryCompact() v5.0 ë³€í™˜
- [ ] EntryModal ì…ë ¥ ìœ íš¨ì„± ê²€ì¦

### 8.2 Integration Tests

- [ ] ì „ì²´ ì‚­ì œ í›„ AI ì¬ìƒì„± â†’ v5.0 êµ¬ì¡° í™•ì¸
- [ ] "Bizen" ê²€ìƒ‰ â†’ configKeywords ë§¤ì¹­ â†’ ëª¨ë“  íšŒì„  í‘œì‹œ
- [ ] "SKì‰´ë”ìŠ¤" ê²€ìƒ‰ â†’ searchAliases ë§¤ì¹­ â†’ ëª¨ë“  íšŒì„  í‘œì‹œ
- [ ] í•­ëª© ì¶”ê°€ â†’ ì €ì¥ â†’ ì„œë²„ ì €ì¥ í™•ì¸
- [ ] í•­ëª© ìˆ˜ì • â†’ userEdited=true í™•ì¸
- [ ] ë°±ì—… ìƒì„± â†’ ë³µì› â†’ v4.3 êµ¬ì¡° ë¡¤ë°±

### 8.3 E2E Tests

- [ ] Config ì—…ë¡œë“œ â†’ DictionaryEditor ì—´ê¸° â†’ v5.0 ì‚¬ì „ ìƒì„±
- [ ] AI ì¬ìƒì„± â†’ ê²€ìƒ‰ í…ŒìŠ¤íŠ¸ â†’ ëª¨ë“  ê´€ë ¨ íšŒì„  í‘œì‹œ
- [ ] ë°±ì—… â†’ ì‚­ì œ â†’ ë³µì› â†’ ì •ìƒ ë™ì‘

---

## 9. Success Criteria

### 9.1 Functional Requirements

- [x] DictionaryEntry v5.0 íƒ€ì… ì •ì˜ ì™„ë£Œ
- [x] ì–‘ë°©í–¥ ê²€ìƒ‰ ë¡œì§ êµ¬í˜„ (configKeywords + searchAliases)
- [x] systemPrompt.ts v5.0 ì‘ì„±
- [x] DictionaryEditor 3ê°œ í•„ë“œ ì…ë ¥ UI
- [x] ì „ì²´ ì‚­ì œ í›„ AI ì¬ìƒì„± ê¸°ëŠ¥
- [x] ë°±ì—… ë° ë³µì› ê¸°ëŠ¥

### 9.2 Quality Requirements

- [ ] ê²€ìƒ‰ ì •í™•ë„ 100% (ëª¨ë“  ê´€ë ¨ Config í‚¤ì›Œë“œ ê²€ìƒ‰)
- [ ] íƒ€ì… ì•ˆì „ì„± (TypeScript strict mode)
- [ ] AI ìƒì„± ì‹œê°„ < 5ì´ˆ (100ê°œ description ê¸°ì¤€)
- [ ] ë°±ì—… ë³µì› ì„±ê³µë¥  100%

### 9.3 User Experience

- [ ] 3ê°œ í•„ë“œ ì…ë ¥ì´ ì§ê´€ì ì„
- [ ] ë„ì›€ë§ íˆ´íŒì´ ëª…í™•í•¨
- [ ] AI ì¬ìƒì„± ê²°ê³¼ê°€ ì •í™•í•¨
- [ ] ë°±ì—… ë³µì›ì´ ê°„í¸í•¨

---

## 10. Risks and Mitigations

### 10.1 Technical Risks

| Risk | Probability | Impact | Mitigation |
|------|:-----------:|:------:|-----------|
| AI ìƒì„± í‚¤ì›Œë“œ ë¶„ë¥˜ ì˜¤ë¥˜ | Medium | High | ì‚¬ìš©ì ìˆ˜ë™ ê²€í†  í›„ ìˆ˜ì • ê°€ëŠ¥ |
| ë°±ì—… íŒŒì¼ ì†ìƒ | Low | High | ë°±ì—… íŒŒì¼ ê²€ì¦, ì—¬ëŸ¬ ë°±ì—… ë³´ê´€ |
| ê²€ìƒ‰ ë¡œì§ ë²„ê·¸ (ì–‘ë°©í–¥ ê²€ìƒ‰) | Low | High | ë‹¨ìœ„ í…ŒìŠ¤íŠ¸, E2E í…ŒìŠ¤íŠ¸ |

### 10.2 User Experience Risks

| Risk | Probability | Impact | Mitigation |
|------|:-----------:|:------:|-----------|
| 3ê°œ í•„ë“œ ì…ë ¥ ë³µì¡ë„ | Medium | Low | ë„ì›€ë§ íˆ´íŒ, ì˜ˆì‹œ ì œê³µ |
| AI ì¬ìƒì„± ê²°ê³¼ ë¶€ì •í™• | Medium | Medium | ìˆ˜ë™ ìˆ˜ì • ê°€ëŠ¥, ì¬ìƒì„± ë²„íŠ¼ |
| ê¸°ì¡´ ì‚¬ì „ ì†ì‹¤ ë¶ˆì•ˆ | Low | High | ë°±ì—… ìë™ ìƒì„±, ë³µì› ê¸°ëŠ¥ |

---

## 11. Appendix

### 11.1 Glossary

| Term | Definition |
|------|------------|
| **configKeywords** | Config descriptionì—ì„œ ê²€ìƒ‰í•  í‚¤ì›Œë“œë“¤ (ì˜ˆ: ["Bizen", "ADTCAPS"]) |
| **searchAliases** | ì¶”ê°€ ì‚¬ìš©ì ê²€ìƒ‰ì–´ë“¤ (ì˜ˆ: ["SKì‰´ë”ìŠ¤", "ISAC"]) |
| **Bidirectional Search** | configKeywords + searchAliases ëª¨ë‘ ì‚¬ìš©ì ì…ë ¥ìœ¼ë¡œ ë§¤ì¹­ |
| **OR Condition** | configKeywords ì¤‘ í•˜ë‚˜ë¼ë„ í¬í•¨ëœ ì„œë¹„ìŠ¤ ê²€ìƒ‰ |
| **groupName** | entry.name (ê·¸ë£¹ ëŒ€í‘œ ì´ë¦„) |
| **matchedAlias** | ì‹¤ì œë¡œ ë§¤ì¹­ëœ í‚¤ì›Œë“œ (configKeywords ë˜ëŠ” searchAliases ì¤‘) |

### 11.2 References

- **Plan Document**: `docs/01-plan/features/dictionary-structure-v5.plan.md`
- **v4.3 Design**: `docs/02-design/features/dictionary-simplification.design.md`
- **TypeScript Handbook**: https://www.typescriptlang.org/docs/handbook/
- **React Hook Forms**: https://react-hook-form.com/

---

**Last Updated**: 2026-02-16
**Document Version**: 1.0
**Status**: ğŸ¨ Design
**Next Step**: Implementation (Do Phase)
